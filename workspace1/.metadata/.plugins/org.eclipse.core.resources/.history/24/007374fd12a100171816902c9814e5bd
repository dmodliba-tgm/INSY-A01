package jdbcdemo;

import java.io.FileInputStream;
import java.sql.*;
import java.util.Properties;

public class FlughafenDAO {

	private Connection myConn;
	
	public FlughafenDAO() throws Exception {
		
		Properties props = new Properties();
		props.load(new FileInputStream("flightdata.properties"));
		
		String user = props.getProperty("user");
		String password = props.getProperty("password");
		String dburl = props.getProperty("dburl");	
		
		myConn = DriverManager.getConnection(dburl, user, password);
		
		System.out.println("DB conncetion successful to: " + dburl);	
	}
	
	public List<Flughaefen> getAllFlughaefen() throws Exception {
		List <Flughaefen> list = new ArrayList<>();
		
		Statement myStmt = null;
		ResultSet myRs = null;
		
		try {
			myStmt = myConn.createStatement();
			myRs = myStmt.executeQuery("select * from airports");
			
			while (myRs.next()) {
				Flughaefen tempFlughaefen = convertRowToFlughaefen(myRs);
				list.add(tempFlughaefen);
			}
			return list;
		}
		finally {
			close(myStmt, myRs);
		}
	}
	
}
